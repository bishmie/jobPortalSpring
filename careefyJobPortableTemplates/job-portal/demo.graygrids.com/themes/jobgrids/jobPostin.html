<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
          rel="stylesheet">

    <!-- ========================= CSS here ========================= -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/LineIcons.2.0.css" />
    <link rel="stylesheet" href="assets/css/animate.css" />
    <link rel="stylesheet" href="assets/css/tiny-slider.css" />
    <link rel="stylesheet" href="assets/css/glightbox.min.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body>

<!-- Start Header Area -->
<header class="header other-page">
    <div class="navbar-area">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <nav class="navbar navbar-expand-lg">
                        <a class="navbar-brand logo" href="index-2.html">
                            <img class="logo1" src="assets/images/logo/logo.svg" alt="Logo" />
                        </a>
                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                                aria-expanded="false" aria-label="Toggle navigation">
                            <span class="toggler-icon"></span>
                            <span class="toggler-icon"></span>
                            <span class="toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse sub-menu-bar" id="navbarSupportedContent">
                            <ul id="nav" class="navbar-nav ml-auto">
                                <li class="nav-item">
                                    <a href="index-2.html">Home</a>
                                    <ul class="sub-menu">
                                        <li><a href="index-2.html">Home 1</a></li>
                                        <li><a href="index2.html">Home 2</a></li>
                                        <li><a href="index3.html">Home 3</a></li>
                                        <li><a href="index4.html">Home 4</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a href="#">Pages</a>
                                    <ul class="sub-menu">
                                        <li><a href="about-us.html">About Us</a></li>
                                        <li><a href="job-list.html">Job List</a></li>
                                        <li><a href="job-details.html">Job Details</a></li>
                                        <li><a href="resume.html">Resume Page</a></li>
                                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                                        <li><a href="faq.html">Faq</a></li>
                                        <li><a href="pricing.html">Our Pricing</a></li>
                                        <li><a href="404.html">404 Error</a></li>
                                        <li><a href="mail-success.html">Mail Success</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a href="#">Candidates</a>
                                    <ul class="sub-menu">
                                        <li><a href="browse-jobs.html">Browse Jobs</a></li>
                                        <li><a href="browse-categories.html">Browse Categories</a></li>
                                        <li><a href="add-resume.html">Add Resume</a></li>
                                        <li><a href="job-alerts.html">Job Alerts</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a href="#" class="active">Employers </a>
                                    <ul class="sub-menu">
                                        <li><a href="post-job.html" class="active">Add Job</a></li>
                                        <li><a href="manage-jobs.html">Manage Jobs</a></li>
                                        <li><a href="manage-applications.html">Manage Applications</a></li>
                                        <li><a href="manage-resumes.html">Manage Resume</a></li>
                                        <li><a href="browse-resumes.html">Browse Resumes</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a href="#">Blog</a>
                                    <ul class="sub-menu">
                                        <li><a href="blog-grid-sidebar.html">Blog Grid Sidebar</a></li>
                                        <li><a href="blog-single.html">Blog Single</a></li>
                                        <li><a href="blog-single-sidebar.html">Blog Single Sibebar</a></li>
                                    </ul>
                                </li>
                                <li class="nav-item"><a href="contact.html">Contact </a> </li>
                            </ul>
                        </div>
                        <!-- navbar collapse -->
                        <div class="button">
                            <a href="#" data-toggle="modal" data-target="#login" class="login"><i
                                    class="lni lni-lock-alt"></i> Login</a>
                            <a href="#" data-toggle="modal" data-target="#signup" class="btn">Sign Up</a>
                        </div>
                    </nav>
                    <!-- navbar -->
                </div>
            </div>
            <!-- row -->
        </div>
        <!-- container -->
    </div>
    <!-- navbar area -->
</header>
<!-- End Header Area -->


<section class="job-post section">
    <div class="container">
        <div class="row">
            <div class="col-lg-10 offset-lg-1 col-12">
                <div class="job-information">
                    <h3 class="title">Job Information</h3>
                    <form id="jobPostForm">
                        <input type="hidden" id="user_id" name="user_id">
                        <input type="hidden" id="category_id" name="category_id">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Job title*</label>
                                    <input class="form-control" type="text" name="title" id="title">
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Job Description*</label>
                                    <textarea name="message" class="form-control" id="description" rows="5"></textarea>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Responsibilities*</label>
                                    <textarea name="ResponsibilitiesMessage" id="responsibilities" class="form-control" rows="5"></textarea>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Experiences*</label>
                                    <textarea name="ExMessage"  id="experience" class="form-control" rows="5"></textarea>
                                </div>
                            </div>

                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Location*</label>
                                    <input class="form-control" id="location" type="text" name="location">
                                </div>
                            </div>


                            <div class="col-lg-6 col-md-6">
                                <div class="form-group">
                                    <label>Job Types*</label>
                                    <select name="jobType" class="select" id="jobType">
                                        <option value="1">Full Time</option>
                                        <option value="2">Part Time</option>
                                        <option value="3">Contract</option>
                                        <option value="4">Internship</option>
                                        <option value="5">Office</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Salary*</label>
                                    <input class="form-control" type="text" name="salary" placeholder="35000.00" id="salary">
                                </div>
                            </div>

                            <div class="col-lg-6 col-md-6">
                                <div class="form-group">
                                    <label>Category*</label>
                                    <select class="select" id="jobTypeSelect">
                                        <option value="">Select Job Type</option> <!-- Default empty option -->
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-6 col-md-6">
                                <div class="form-group">
                                    <label>Application Deadline</label>
                                    <div class="input-group date" id="datetimepicker">
                                        <input type="text" class="form-control" id="date"  placeholder="12/11/2020">
                                        <span class="input-group-addon"></span>
                                        <i class="bx bx-calendar"></i>
                                    </div>
                                </div>
                            </div>



                        </div>
                        <h3 class="title">Company Information</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Company Name</label>
                                    <input class="form-control" type="text" id="companyName" name="Company">
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input class="form-control" id="email" type="text" name="Email">
                                </div>
                            </div>



                            <div class="col-lg-12">
                                <div class="form-group">
                                    <label>Company Description*</label>
                                    <textarea name="CompanyDesc" class="form-control" id="comDesc" rows="5"></textarea>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <div class="choose-img">
                                    <p>Logo (Optional)</p>
                                    <label for="img">Select image:</label>
                                    <input type="file" id="img" name="img" accept="image/*">
                                    <p>Maximum file size: 2 MB</p>
                                </div>
                            </div>
                        </div>


<!--                        <div class="col-12">-->
<!--                            <div class="form-group checkboxs">-->
<!--                                <input type="checkbox" class="checkboxs" id="chb2">-->
<!--                                <p>-->
<!--                                    By clicking checkbox, you agree to our <a href="terms-conditions.html">Terms-->
<!--                                    &-->
<!--                                    Conditions</a> And <a href="privacy-policy.html">Privacy Policy.</a>-->
<!--                                </p>-->
<!--                            </div>-->
<!--                        </div>-->
                        <div class="col-lg-12 button">
                            <button class="btn" id="submit">
                                Post a Job
                            </button>
                        </div>
                </div>

                </form>

            </div>
        </div>
    </div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>


<!--<script>-->
<!--    // Function to load job types-->
<!--    function loadJobTypes() {-->
<!--        // Make AJAX request to fetch job types-->
<!--        fetch('http://localhost:8090/jobType/getAll', {-->
<!--            method: 'GET',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json'-->
<!--            }-->
<!--        })-->
<!--            .then(response => response.json()) // Parse the JSON response-->
<!--            .then(data => {-->
<!--                // Get the select dropdown element-->
<!--                const selectElement = document.getElementById('jobTypeSelect');-->

<!--                // Clear the dropdown (optional)-->
<!--                selectElement.innerHTML = '<option value="">Select Job Type</option>';-->

<!--                // Loop through the fetched job types and append them to the dropdown-->
<!--                data.forEach(jobType => {-->
<!--                    const option = document.createElement('option');-->
<!--                    option.value = jobType.id; // Assuming each jobType object has an 'id' property-->
<!--                    option.textContent = jobType.name; // Assuming each jobType object has a 'name' property-->
<!--                    selectElement.appendChild(option);-->
<!--                });-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error fetching job types:', error);-->
<!--            });-->
<!--    }-->

<!--    // Call the function when the page loads-->
<!--    window.onload = loadJobTypes;-->
<!--</script>-->
<!--<script>-->


<!--    $(document).ready(function () {-->
<!--        $("#jobPostForm").submit(function (event) {-->
<!--            event.preventDefault(); // Form eka auto submit wena eka nawattanna-->

<!--            let token = localStorage.getItem("token"); // Token eka localStorage eken ganna-->

<!--            if (!token) {-->
<!--                alert("User not logged in!");-->
<!--                return;-->
<!--            }-->

<!--            // **Step 1: Employer ID eka ganna**-->
<!--            $.ajax({-->
<!--                url: "http://localhost:8090/users/getUserIdFromToken",-->
<!--                type: "GET",-->
<!--                headers: { "Authorization": "Bearer " + token },-->
<!--                success: function (response) {-->
<!--                    let employerId = response.userId;-->

<!--                    // **Step 2: Form Data collect karanna**-->
<!--                    let formData = {-->
<!--                        title: $("input[name='title']").val(),-->
<!--                        description: $("textarea[name='message']").val(),-->
<!--                        responsibilities: $("textarea[name='ResponsibilitiesMessage']").val(),-->
<!--                        experience: $("textarea[name='ExMessage']").val(),-->
<!--                        location: $("input[name='location']").val(),-->
<!--                        type: $(".select[name='jobType']").val(),-->
<!--                        salary: $(".select[name='salary']").val(),-->
<!--                        jobTypeId: $(".select[name='Category']").val(),-->
<!--                        deadline: $("input[placeholder='12/11/2020']").val(),-->
<!--                        companyId: 1, // Company ID eka select karanna one-->
<!--                        employerId: employerId, // Employer ID eka insert karanawa-->
<!--                    };-->

<!--                    // **Step 3: Job eka backend ekata yawanna**-->
<!--                    $.ajax({-->
<!--                        url: "http://localhost:8090/jobs/add",-->
<!--                        type: "POST",-->
<!--                        contentType: "application/json",-->
<!--                        data: JSON.stringify(formData),-->
<!--                        success: function (response) {-->
<!--                            alert("Job Posted Successfully!");-->
<!--                        },-->
<!--                        error: function () {-->
<!--                            alert("Error Posting Job!");-->
<!--                        },-->
<!--                    });-->
<!--                },-->
<!--                error: function () {-->
<!--                    alert("Error fetching employer ID!");-->
<!--                },-->
<!--            });-->
<!--        });-->
<!--    });-->

<!--</script>-->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<script>

    document.addEventListener("DOMContentLoaded", function () {

        // Function to load job types dynamically from backend
        function loadJobTypes() {
            fetch('http://localhost:8090/jobType/getAll', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    const selectElement = document.getElementById('jobTypeSelect');
                    selectElement.innerHTML = '<option value="">Select Job Type</option>'; // Clear options
                    data.forEach(jobType => {
                        const option = document.createElement('option');
                        option.value = jobType.id;  // Assuming jobType has an 'id' field
                        option.textContent = jobType.name;  // Assuming jobType has a 'name' field
                        selectElement.appendChild(option);
                    });
                })
                .catch(error => console.error('Error fetching job types:', error));
        }

        // Load job types when the page is ready
        loadJobTypes();
    } );

</script>

<script>


        $(document).ready(function () {
        const token = localStorage.getItem("authToken"); // Get token
        console.log("JWT Token:", token);  // Log the token to see if it's valid

        if (!token) {
        alert("User not authenticated!");
        return;
    }

        try {
        const decoded = jwt_decode(token);
        console.log("Decoded Token:", decoded);
        const userEmail = decoded.email || decoded.sub;
        console.log("User Email:", userEmail);

        if (!userEmail) {
        alert("Email not found in token!");
        return;
    }

        // Get User ID
        $.ajax({
        url: `http://localhost:8090/users/getByEmail`,
        method: "GET",
        headers: {
        "Authorization": "Bearer " + token,
        "Content-Type": "application/json"
    },
        success: function (userData) {
        console.log("User data from API:", userData);
        const userId = userData.userId;

        if (!userId) {
        alert("User ID not found in the response");
        return;
    }

        console.log("User ID:", userId);

        // Form Submission
        $('#jobPostForm').submit(function (e) {
        e.preventDefault();

        var title = $('#title').val().trim();
        var description = $('#description').val().trim();
        var responsibilities = $('#responsibilities').val().trim();
        var experience = $('#experience').val().trim();
        var location = $('#location').val().trim();
        var jobType = $('#jobType').val();
        var salary = $('#salary').val().trim();
        var category = $('#jobTypeSelect').val();
        var deadline = $('#date').val().trim();
        var companyName = $('#companyName').val().trim();
        var emails = $('#email').val().trim();
        // var fileInput = document.getElementById("img");
        // var file = fileInput.files[0]; // Get file properly

        console.log("Title:", $('#title').val().trim());
        console.log("Description:", $('#description').val().trim());
        console.log("Responsibilities:", $('#responsibilities').val().trim());
        console.log("Experience:", $('#experience').val().trim());
        console.log("Location:", $('#location').val().trim());
        console.log("Job Type:", $('#jobType').val());
        console.log("Salary:", $('#salary').val().trim());
        console.log("Category:", $('#jobTypeSelect').val());
        console.log("Deadline:", $('#date').val().trim());
        console.log("Company Name:", $('#companyName').val().trim());
        console.log("Email:", $('#email').val().trim());

        var fileInput = document.getElementById("img");
        var file = fileInput.files[0];
        console.log("File:", file ? file.name : "No file selected");

        if (!title || !description || !responsibilities || !experience || !location || !jobType || !salary || !category || !deadline || !companyName || !emails || !file) {
        Swal.fire("Oops...", "Please fill all fields!", "warning");
        return;
    }

        // Use FormData for file upload
        var formData = new FormData();
        formData.append("job", JSON.stringify({
        title: title,
        description: description,
        responsibilities: responsibilities,
        experience: experience,
        location: location,
        jobType: jobType,
        salary: salary,
        category: category,
        deadline: deadline,
        companyName: companyName,
        email: emails,
            file:file,
            userId:userId
    }));
        formData.append("files", file);
        formData.append("userId", userId);

        $.ajax({
        url: 'http://localhost:8090/jobs/add',
        type: 'POST',
        headers: {
        "Authorization": "Bearer " + token
    },
        processData: false,
        contentType: false,
        data: formData,
        success: function (response) {
        console.log("Response:", response);

        if (response.code === 201) {
        Swal.fire({
        icon: "success",
        title: "Job Posted Successfully",
        text: "Redirecting...",
        showConfirmButton: false,
        timer: 2000
    }).then(() => {
        console.log("Job posted successfully!");
    });
    } else {
        Swal.fire("Posting Failed", response.message, "error");
    }
    },
        error: function (xhr) {
        console.log("Error:", xhr.responseText);
        Swal.fire("Error!", "There was an error: " + xhr.responseText, "error");
    }
    });
    });

    },
        error: function () {
        alert("User not found");
    }
    });

    } catch (error) {
        console.error("Error:", error);
        alert("Error retrieving user data!");
    }
    });

// $(document).ready(function () {
    //     const token = localStorage.getItem("authToken"); // Get token
    //     console.log("JWT Token:", token);  // Log the token to see if it's valid
    //
    //     if (!token) {
    //         alert("User not authenticated!");
    //         return;
    //     }
    //
    //     try {
    //         const decoded = jwt_decode(token);
    //         console.log("Decoded Token:", decoded);
    //         const userEmail = decoded.email || decoded.sub;
    //         console.log("User Email:", userEmail);
    //
    //         if (!userEmail) {
    //             alert("Email not found in token!");
    //             return;
    //         }
    //
    //         // Get User ID
    //         $.ajax({
    //             url: `http://localhost:8090/users/getByEmail`,
    //             method: "GET",
    //             headers: {
    //                 "Authorization": "Bearer " + token,
    //                 "Content-Type": "application/json"
    //             },
    //             success: function (userData) {
    //                 console.log("User data from API:", userData);
    //                 const userId = userData.userId;
    //
    //                 if (!userId) {
    //                     alert("User ID not found in the response");
    //                     return;
    //                 }
    //
    //                 console.log("User ID:", userId);
    //
    //                 // Form Submission
    //                 $('#jobPostForm').submit(function (e) {
    //                     e.preventDefault();
    //
    //                     var title = $('#title').val().trim();
    //                     var description = $('#description').val().trim();
    //                     var responsibilities = $('#responsibilities').val().trim();
    //                     var experience = $('#experience').val().trim();
    //                     var location = $('#location').val().trim();
    //                     var jobType = $('#jobType').val();
    //                     var salary = $('#salary').val().trim();
    //                     var category = $('#jobTypeSelect').val();
    //                     var deadline = $('#date').val().trim();
    //                     var companyName = $('#companyName').val().trim();
    //                     var emails = $('#email').val().trim();
    //                     var fileInput = document.getElementById("img");
    //                     var file = fileInput.files[0]; // Get file properly
    //
    //                     console.log("Title:", $('#title').val().trim());
    //                     console.log("Description:", $('#description').val().trim());
    //                     console.log("Responsibilities:", $('#responsibilities').val().trim());
    //                     console.log("Experience:", $('#experience').val().trim());
    //                     console.log("Location:", $('#location').val().trim());
    //                     console.log("Job Type:", $('#jobType').val());
    //                     console.log("Salary:", $('#salary').val().trim());
    //                     console.log("Category:", $('#jobTypeSelect').val());
    //                     console.log("Deadline:", $('#date').val().trim());
    //                     console.log("Company Name:", $('#companyName').val().trim());
    //                     console.log("Email:", $('#email').val().trim());
    //
    //                     var fileInput = document.getElementById("img");
    //                     var file = fileInput.files[0];
    //                     console.log("File:", file ? file.name : "No file selected");
    //
    //
    //                     if (!title || !description || !responsibilities || !experience || !location || !jobType || !salary || !category || !deadline || !companyName || !emails || !file) {
    //                         Swal.fire("Oops...", "Please fill all fields!", "warning");
    //                         return;
    //                     }
    //
    //                     // Use FormData for file upload
    //                     var formData = new FormData();
    //                     formData.append("title", title);
    //                     formData.append("description", description);
    //                     formData.append("responsibilities", responsibilities);
    //                     formData.append("experience", experience);
    //                     formData.append("location", location);
    //                     formData.append("jobType", jobType);
    //                     formData.append("salary", salary);
    //                     formData.append("category", category);
    //                     formData.append("deadline", deadline);
    //                     formData.append("companyName", companyName);
    //                     formData.append("emails", emails);
    //                     formData.append("file", file); // Append file
    //                     formData.append("userId", userId);
    //                    // Append userId
    //
    //                     $.ajax({
    //                         url: 'http://localhost:8090/jobs/add',
    //                         type: 'POST',
    //                         headers: {
    //                             "Authorization": "Bearer " + token,
    //                             "Content-Type": "multipart/form-data"
    //
    //                         },
    //                         processData: false,
    //                         contentType: false,
    //                         data: formData,
    //                         success: function (response) {
    //                             console.log("Response:", response);
    //
    //                             if (response.code === 201) {
    //                                 Swal.fire({
    //                                     icon: "success",
    //                                     title: "Job Posted Successfully",
    //                                     text: "Redirecting...",
    //                                     showConfirmButton: false,
    //                                     timer: 2000
    //                                 }).then(() => {
    //                                     console.log("Job posted successfully!");
    //                                 });
    //                             } else {
    //                                 Swal.fire("Posting Failed", response.message, "error");
    //                             }
    //                         },
    //                         error: function (xhr) {
    //                             console.log("Error:", xhr.responseText);
    //                             Swal.fire("Error!", "There was an error: " + xhr.responseText, "error");
    //                         }
    //                     });
    //                 });
    //
    //             },
    //             error: function () {
    //                 alert("User not found");
    //             }
    //         });
    //
    //     } catch (error) {
    //         console.error("Error:", error);
    //         alert("Error retrieving user data!");
    //     }
    // });




    //
    // document.getElementById("jobPostForm").addEventListener("submit", function (event) {
    //         event.preventDefault(); // Avoid form submission
    //
    //         const token = localStorage.getItem("authToken"); // Get token
    //         console.log("JWT Token:", token);  // Log the token to see if it's valid
    //
    //         if (!token) {
    //             alert("User not authenticated!");
    //             return;
    //         }
    //
    //         try {
    //             const decoded = jwt_decode(token);
    //             console.log("Decoded Token:", decoded);
    //             const userEmail = decoded.email || decoded.sub;
    //             console.log("User Email:", userEmail);
    //
    //             if (!userEmail) {
    //                 alert("Email not found in token!");
    //                 return;
    //             }
    //
    //             // Backend API to get user ID based on email using AJAX
    //             $.ajax({
    //                 url: `http://localhost:8090/users/getByEmail`,
    //                 method: "GET",
    //                 headers: {
    //                     "Authorization": "Bearer " + token,
    //                     "Content-Type": "application/json"
    //                 },
    //                 success: function (userData) {
    //                     console.log("User data from API:", userData);
    //
    //                     const userId = userData.userId;
    //                     console.log(userId)
    //                     if (!userId) {
    //                         alert("User ID not found in the response");
    //                         return;
    //                     }
    //                     console.log(userId)
    //
    //                     // Get form data
    //                     const formData = new FormData(event.target);
    //                     // const formattedDeadline = moment(deadline, "MM/DD/YYYY").format("YYYY-MM-DD");
    //                     const jobData = {
    //                         title: formData.get("title"),
    //                         description: formData.get("message"),
    //                         responsibilities: formData.get("ResponsibilitiesMessage"),
    //                         experience: formData.get("ExMessage"),
    //                         location: formData.get("location"),
    //                         jobTypeId: document.querySelector(".select[name='jobType']").value,
    //                         salary: formData.get("salary"),
    //                          deadline :document.getElementById("date").value,
    //                         companyName: formData.get("Company"),
    //                         email: formData.get("Email"),
    //                         companyDescription: formData.get("CompanyDesc"),
    //                         logo: formData.get("img"),
    //                         userId: userId // Send User ID in job data
    //                     };
    //
    //                     console.log(jobData); // Debugging
    //
    //                     // Send job post request using AJAX
    //                     $.ajax({
    //                         url: "http://localhost:8090/jobs/add",
    //                         method: "POST",
    //                         headers: {
    //                             "Authorization": "Bearer " + token,
    //                             "Content-Type": "application/json"
    //                         },
    //                         data: JSON.stringify(jobData),
    //                         success: function () {
    //                             alert("Job posted successfully!");
    //                             // window.location.reload(); // Reload page on success
    //                         },
    //                         error: function (error) {
    //                             console.error("Error:", error);
    //                             alert("Error posting job!");
    //                         }
    //                     });
    //                 },
    //                 error: function () {
    //                     alert("User not found");
    //                 }
    //             });
    //         } catch (error) {
    //             console.error("Error:", error);
    //             alert("Error posting job!");
    //         }
    //     });




        // Handle form submission
    //     document.getElementById("jobPostForm").addEventListener("submit", async function(event) {
    //         event.preventDefault(); // Prevent default form submission
    //
    //         const token = localStorage.getItem("authToken"); // Retrieve token
    //         if (!token) {
    //             alert("User not authenticated!");
    //             return;
    //         }
    //
    //         try {
    //             const decoded = jwt_decode(token);
    //             console.log(decoded); // Debugging: Check the decoded token
    //             console.log(decoded.user_id)
    //             return decoded.user_id; // Assuming the JWT contains 'user_id'
    //         } catch (e) {
    //             console.error("Error decoding token:", e);
    //             return null;
    //         }
    //
    //
    //         const formData = new FormData(event.target);
    //         const jobData = {
    //             title: formData.get("title"),
    //             description: formData.get("message"),
    //             responsibilities: formData.get("ResponsibilitiesMessage"),
    //             experience: formData.get("ExMessage"),
    //             location: formData.get("location"),
    //             jobTypeId: document.querySelector(".select[name='jobType']").value, // Job Type
    //             salary: document.querySelector(".select[name='salaryCurrency']").value, // Salary Currency
    //             deadline: formData.get("deadline"), // Deadline
    //             companyName: formData.get("Company"), // Company Name
    //             email: formData.get("Email"), // Company Email
    //             company_description: formData.get("companyDesc"), // Company Description
    //             logo: formData.get("img")
    //             // Company Logo (File)
    //
    //         };
    //
    //         console.log(jobData);
    //
    //
    //         try {
    //             const response = await fetch("http://localhost:8090/jobs/add", {
    //                 method: "POST",
    //                 headers: {
    //                     "Content-Type": "application/json",
    //                     "Authorization": `Bearer ${token}`
    //                 },
    //                 body: JSON.stringify(jobData)
    //             });
    //
    //             if (!response.ok) throw new Error("Failed to post job");
    //
    //             alert("Job posted successfully!");
    //             window.location.reload(); // Reload page after successful submission
    //         } catch (error) {
    //             console.error("Error:", error);
    //             alert("Error posting job!");
    //         }
    //     });
    //
    // });

</script>
</body>
</html>




<!--document.getElementById("jobPostForm").addEventListener("submit", async function (event) {-->
<!--event.preventDefault(); // Form submission avoid කරන්න-->

<!--const token = localStorage.getItem("authToken"); // Token එක ගන්න-->
<!--if (!token) {-->
<!--alert("User not authenticated!");-->
<!--return;-->
<!--}-->

<!--try {-->
<!--const decoded = jwt_decode(token);-->
<!--const userEmail = decoded.email || decoded.sub;-->
<!--console.log("User Email:", userEmail);-->

<!--console.log(decoded)-->
<!--console.log("Decoded Email:", userEmail, "Type:", typeof userEmail);-->


<!--if (!userEmail) {-->
<!--alert("Email not found in token!");-->
<!--console.log("Decoded Email:", userEmail, "Type:", typeof userEmail);-->

<!--return;-->
<!--}-->

<!--// Backend එකේ `getByEmail` API එකෙන් user ID එක ගන්න-->
<!--const userResponse = await fetch(`http://localhost:8090/users/getByEmail`, {-->
<!--method: "GET",-->
<!--headers: {-->
<!--"Authorization": "Bearer " + token,-->
<!--"Content-Type": "application/json"-->
<!--}-->
<!--});-->

<!--if (!userResponse.ok) {-->
<!--throw new Error("User not found");-->
<!--}-->

<!--const userData = await userResponse.json();-->
<!--console.log("User data from API:", userData); // Log the user data response-->

<!--const userId = userData.userId;-->
<!--if (!userId) {-->
<!--alert("User ID not found in the response");-->
<!--return;-->
<!--}-->

<!--// Now you can proceed with using the userId in jobData-->


<!--// Form එකේ data එක ගන්න-->
<!--const formData = new FormData(event.target);-->
<!--const jobData = {-->
<!--title: formData.get("title"),-->
<!--description: formData.get("message"),-->
<!--responsibilities: formData.get("ResponsibilitiesMessage"),-->
<!--experience: formData.get("ExMessage"),-->
<!--location: formData.get("location"),-->
<!--jobTypeId: document.querySelector(".select[name='jobType']").value,-->
<!--salary: document.querySelector(".select[name='salaryCurrency']").value,-->
<!--deadline: formData.get("datetimepicker"),-->
<!--companyName: formData.get("Company"),-->
<!--email: formData.get("Email"),-->
<!--companyDescription: formData.get("CompanyDesc"),-->
<!--logo: formData.get("img"),-->
<!--userId: userId // User ID එක Job entity එකට යවන්න-->
<!--};-->

<!--console.log(jobData); // Debugging-->

<!--// Backend එකට job post request එක යවන්න-->
<!--const response = await fetch("http://localhost:8090/jobs/add", {-->
<!--method: "POST",-->
<!--headers: {-->
<!--"Content-Type": "application/json",-->
<!--"Authorization": "Bearer " + localStorage.getItem("token"),-->
<!--},-->
<!--body: JSON.stringify(jobData)-->
<!--});-->

<!--if (!response.ok) throw new Error("Failed to post job");-->

<!--alert("Job posted successfully!");-->
<!--window.location.reload(); // Success නම් page එක reload කරන්න-->
<!--} catch (error) {-->
<!--console.error("Error:", error);-->
<!--alert("Error posting job!");-->
<!--console.log(jobData); // Debugging-->

<!--}-->
<!--});-->
<!--*/-->